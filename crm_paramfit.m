g = @(x,p)  p(1).*exp(p(2).*x) + p(3);

R_series0 =  0.0176725770193065; 
R_10 = 0.0300931359624154; 
C_10 = 89; 
R_20 = 0.019421970865732; 
C_20 = 3506.11460380014; 
R_30 = 0.019421970865732;
C_30 = 3506.11460380014; 

p0 = [R_series0,R_10,C_10,R_20,C_20,R_30,C_30];

x=[0.87998,0.735467282528717,0.561090954566274,0.44127,0.36943,0.1481462082476085];
% R_series
yp(1,:)=p0(1)*[2.1,0.19319,0.30923,2.5976e-15,0.12736,0.12736];
% R_1
yp(2,:)=p0(2)*[0.6,1.2535,1.0467, 1.0913,1.0632,1.0632];
% C_1
yp(3,:)=p0(3)*[1,1,1,1,1,1];
% R_2
yp(4,:)=p0(4)*[0.6842, 0.71904, 0.53614, 0.81949, 0.51122,0.51122];
% C_2
yp(5,:)=p0(5)*[1.6065, 1.572, 1.8128, 1.1658, 2.1337, 2.1337];
% R_3
yp(6,:)=p0(6)*[0.6842, 42.835, 3.0334, 3.4178e-09, 1.5288e-09, 1.5288e-09];
% C_3
yp(7,:)=p0(7)*[1.6065, 10.629,12.941,1000,1000,1000];
% K_V_oc
yp(8,:)=[1.03,1.0263,1.0166,1.0073,0.99947, 0.99947];

p = zeros(size(yp,1),3);

for i=1:size(yp,1)
    J = @(p) sum((yp(i,:)-g(x,p)).^2);
    p0 = [0,0,mean(yp(i,:))];
    p(i,:) = fminsearch(J,p0);
end
%%
subplot 331
plot(x,yp(1,:),'o',x,g(x,p(1,:)))
subplot 332
plot(x,yp(2,:),'o',x,g(x,p(2,:)))
subplot 333
plot(x,yp(3,:),'o',x,g(x,p(3,:)))
subplot 334
plot(x,yp(4,:),'o',x,g(x,p(4,:)))
subplot 335
plot(x,yp(5,:),'o',x,g(x,p(5,:)))
subplot 336
plot(x,yp(6,:),'o',x,g(x,p(6,:)))
subplot 337
plot(x,yp(7,:),'o',x,g(x,p(7,:)))
subplot 338
plot(x,yp(8,:),'o',x,g(x,p(8,:)))